\documentclass{article}
\pagestyle{empty}
\usepackage{amsmath}
\begin{document}
\newcommand{\C}{{\bf C}}

\title{How to convert an elliptic curve from Montgomery to Weierstra\ss{} 
       coordinates}

\maketitle

Curve in Montgomery coordinates:
\begin{displaymath}
E: B Y^2 = X^3 + A X^2 + X
\end{displaymath}

With a given  point $(X, ?)$ we can set $Y=1$ and choose the isomorphic 
curve
%
\begin{displaymath}
G Y^2 = X^3 + A X^2 + X
\end{displaymath}
%
with $G = X^3 + A X^2 + X$. Now (X, 1) is a valid point on this curve.
Dividing the equation by $G^3$ yields
%
\begin{displaymath}
\left(\frac{Y}{G}\right)^2 = \left(\frac{X}{G}\right)^3 + 
                             \frac{A}{G} \left(\frac{X}{G}\right)^2 + 
                             \frac{1}{G^2} \left(\frac{X}{G}\right)
\end{displaymath}
%
so we can set $x = X/G$, $y = Y/G$ and receive the curve
\begin{displaymath}
y^2 = x^3 + \frac{A}{G} x^2 + \frac{1}{G^2} x
\end{displaymath}

This is not in short Weierstra\ss{} form yet. By choosing instead
$x = (X+A/3)/G$, $y = Y/G$, $a = (1-A^2/3)/G^2$, 
$b = A (2 A^2 - 9)/(27 G^3)$, we get
\begin{displaymath}
y^2 = x^3 + a x + b
\end{displaymath}

This is the desired curve isomorphic to $E$, with $(x,y)$ corresponding 
to $(X,?)$ on $E$.

\end{document}